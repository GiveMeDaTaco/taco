logging:
  level: INFO
  file: logs/tlptaco_poc.log
  debug_file: logs/tlptaco_poc.debug.log

database:
  host: testwf2-ogei3aaf70dllgfc.env.clearscape.teradata.com
  user: demo_user
  password: BeStrong
  logmech: TD2

eligibility:
  eligibility_table: eligibility_poc
  unique_identifiers:
    - c.customer_id
    - a.account_id
    - r.region_id
    - s.segment_id
  tables:
    - name: customers
      alias: c
      sql: "SELECT customer_id, status FROM customers"
      join_type: ""
      join_conditions: ""
      where_conditions: ""
      unique_index: customer_id
      collect_stats: []
    - name: accounts
      alias: a
      sql: "SELECT customer_id, account_id, acct_type FROM accounts"
      join_type: "LEFT JOIN"
      join_conditions: "a.customer_id = c.customer_id"
      where_conditions: ""
      unique_index: account_id
      collect_stats: []
    - name: regions
      alias: r
      sql: "SELECT customer_id, region_id, region_type FROM regions"
      join_type: "LEFT JOIN"
      join_conditions: "r.customer_id = c.customer_id"
      where_conditions: ""
      unique_index: region_id
      collect_stats: []
    - name: segments
      alias: s
      sql: "SELECT customer_id, segment_id, segment_flag FROM segments"
      join_type: "LEFT JOIN"
      join_conditions: "s.customer_id = c.customer_id"
      where_conditions: ""
      unique_index: segment_id
      collect_stats: []
  conditions:
    # Main channel: only BA filters (base-level checks) are allowed
    main:
      BA:
        - sql: "c.status = 'Active'"
          description: "Customer status is Active"
        - sql: "a.account_id IS NOT NULL"
          description: "Has at least one account"
    # Channel-specific filters and segments
    channels:
      email:
        BA:
          - sql: "c.status = 'Active'"
            description: "Email opt-in"
        promo:
          - sql: "s.segment_flag = 'Promo1'"
            description: "Promo 1 segment"
          - sql: "s.segment_flag = 'Promo2'"
            description: "Promo 2 segment"
        loyalty:
          - sql: "s.segment_flag IN ('FlagA','FlagB')"
            description: "Loyalty flags A or B"
      sms:
        BA:
          - sql: "a.acct_type = 'Savings'"
            description: "SMS opt-in (Savings account)"
        tx:
          - sql: "s.segment_flag = 'HighTx'"
            description: "High transaction segment"
          - sql: "s.segment_flag = 'LowTx'"
            description: "Low transaction segment"
        rfm:
          - sql: "s.segment_flag IN ('FlagA','FlagB')"
            description: "RFM flags A or B"
      push:
        BA: []
        promotions:
          - sql: "s.segment_flag = 'PromoA'"
            description: "Push Promo A"
          - sql: "s.segment_flag = 'PromoB'"
            description: "Push Promo B"
        surveys:
          - sql: "s.segment_flag IN ('FlagA','FlagB')"
            description: "Survey flags A or B"

waterfall:
  output_directory: reports/poc/waterfall
  count_columns:
    - c.customer_id
    - [c.customer_id, a.account_id]
    - [r.region_id, s.segment_id]

output:
  channels:
    email:
      columns:
        - customer_id
        - account_id
        - region_id
        - segment_id
      file_location: reports/poc/email
      file_base_name: email_list
      output_options:
        format: csv
        additional_arguments: {}
        custom_function: ""
      unique_on:
        - customer_id
    sms:
      columns:
        - customer_id
        - account_id
        - region_id
        - segment_id
      file_location: reports/poc/sms
      file_base_name: sms_list
      output_options:
        format: parquet
        additional_arguments: {}
        custom_function: ""
      unique_on:
        - customer_id
    push:
      columns:
        - customer_id
        - account_id
        - region_id
        - segment_id
      file_location: reports/poc/push
      file_base_name: push_list
      output_options:
        format: xlsx
        additional_arguments: {}
        custom_function: ""
      unique_on:
        - customer_id